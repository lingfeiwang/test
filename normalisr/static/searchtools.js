/*
 * searchtools.js
 * ~~~~~~~~~~~~~~~~
 *
 * Sphinx JavaScript utilities for the full-text search.
 *
 * :copyright: Copyright 2007-2020 by the Sphinx team, see AUTHORS.
 * :license: BSD, see LICENSE for details.
 *
 */
if(!Scorer)var Scorer={objNameMatch:11,objPartialMatch:6,objPrio:{0:15,1:5,2:-5},objPrioDefault:0,title:15,partialTitle:7,term:5,partialTerm:2};if(!splitQuery)function splitQuery(e){return e.split(/\s+/)}var Search={_index:null,_queued_query:null,_pulse_status:-1,htmlToText:function(e){var t=document.createElement("span");return t.innerHTML=e,$(t).find(".headerlink").remove(),docContent=$(t).find("[role=main]")[0],docContent===undefined?(console.warn("Content block not found. Sphinx search tries to obtain it via '[role=main]'. Could you check your theme or template."),""):docContent.textContent||docContent.innerText},init:function(){var e=$.getQueryParameters();if(e.q){var t=e.q[0];$('input[name="q"]')[0].value=t,this.performSearch(t)}},loadIndex:function(e){$.ajax({type:"GET",url:e,data:null,dataType:"script",cache:!0,complete:function(t,r){"success"!=r&&(document.getElementById("searchindexloader").src=e)}})},setIndex:function(e){var t;this._index=e,null!==(t=this._queued_query)&&(this._queued_query=null,Search.query(t))},hasIndex:function(){return null!==this._index},deferQuery:function(e){this._queued_query=e},stopPulse:function(){this._pulse_status=0},startPulse:function(){function e(){var t;Search._pulse_status=(Search._pulse_status+1)%4;var r="";for(t=0;t<Search._pulse_status;t++)r+=".";Search.dots.text(r),Search._pulse_status>-1&&window.setTimeout(e,500)}this._pulse_status>=0||e()},performSearch:function(e){this.out=$("#search-results"),this.title=$("<h2>"+_("Searching")+"</h2>").appendTo(this.out),this.dots=$("<span></span>").appendTo(this.title),this.status=$('<p class="search-summary">&nbsp;</p>').appendTo(this.out),this.output=$('<ul class="search"/>').appendTo(this.out),$("#search-progress").text(_("Preparing search...")),this.startPulse(),this.hasIndex()?this.query(e):this.deferQuery(e)},query:function(e){function t(){if(p.length){var e=p.pop(),r=$('<li style="display:none"></li>'),n="",i="";if("dirhtml"===DOCUMENTATION_OPTIONS.BUILDER){var o=e[0]+"/";o.match(/\/index\/$/)?o=o.substring(0,o.length-6):"index/"==o&&(o=""),i=n=DOCUMENTATION_OPTIONS.URL_ROOT+o}else n=DOCUMENTATION_OPTIONS.URL_ROOT+e[0]+DOCUMENTATION_OPTIONS.FILE_SUFFIX,i=e[0]+DOCUMENTATION_OPTIONS.LINK_SUFFIX;r.append($("<a/>").attr("href",i+l+e[2]).html(e[1])),e[3]?(r.append($("<span> ("+e[3]+")</span>")),Search.output.append(r),r.slideDown(5,function(){t()})):DOCUMENTATION_OPTIONS.HAS_SOURCE?$.ajax({url:n,dataType:"text",complete:function(e){var n=e.responseText;""!==n&&n!==undefined&&r.append(Search.makeSearchSummary(n,a,s)),Search.output.append(r),r.slideDown(5,function(){t()})}}):(Search.output.append(r),r.slideDown(5,function(){t()}))}else Search.stopPulse(),Search.title.text(_("Search Results")),S?Search.status.text(_("Search finished, found %s page(s) matching the search query.").replace("%s",S)):Search.status.text(_("Your search did not match any documents. Please make sure that all words are spelled correctly and that you've selected enough categories.")),Search.status.fadeIn(500)}var r,n=new Stemmer,a=[],i=[],s=[],o=splitQuery(e),u=[];for(r=0;r<o.length;r++)if(""!==o[r]&&u.push(o[r].toLowerCase()),-1==$u.indexOf(stopwords,o[r].toLowerCase())&&""!==o[r]){var c,h=n.stemWord(o[r].toLowerCase());h.length<3&&o[r].length>=3&&(h=o[r]),"-"==h[0]?(c=i,h=h.substr(1)):(c=a,s.push(o[r].toLowerCase())),$u.contains(c,h)||c.push(h)}var l="?highlight="+$.urlencode(s.join(" ")),d=this._index.terms,f=this._index.titleterms,p=[];for($("#search-progress").empty(),r=0;r<u.length;r++){var m=[].concat(u.slice(0,r),u.slice(r+1,u.length));p=p.concat(this.performObjectSearch(u[r],m))}if(p=p.concat(this.performTermsSearch(a,i,d,f)),Scorer.score)for(r=0;r<p.length;r++)p[r][4]=Scorer.score(p[r]);p.sort(function(e,t){var r=e[4],n=t[4];return r>n?1:r<n?-1:(r=e[1].toLowerCase())>(n=t[1].toLowerCase())?-1:r<n?1:0});var S=p.length;t()},performObjectSearch:function(e,t){var r,n=this._index.filenames,a=this._index.docnames,i=this._index.objects,s=this._index.objnames,o=this._index.titles,u=[];for(var c in i)for(var h in i[c]){var l=(c?c+".":"")+h,d=l.toLowerCase();if(d.indexOf(e)>-1){var f=0,p=d.split(".");d==e||p[p.length-1]==e?f+=Scorer.objNameMatch:p[p.length-1].indexOf(e)>-1&&(f+=Scorer.objPartialMatch);var m=i[c][h],S=s[m[1]][2],x=o[m[0]];if(t.length>0){var g=(c+" "+h+" "+S+" "+x).toLowerCase(),v=!0;for(r=0;r<t.length;r++)if(-1==g.indexOf(t[r])){v=!1;break}if(!v)continue}var T=S+_(", in ")+x,O=m[3];""===O?O=l:"-"==O&&(O=s[m[1]][1]+"-"+l),Scorer.objPrio.hasOwnProperty(m[2])?f+=Scorer.objPrio[m[2]]:f+=Scorer.objPrioDefault,u.push([a[m[0]],l,"#"+O,T,f,n[m[0]]])}}return u},performTermsSearch:function(e,t,r,n){var a,i,s,o=this._index.docnames,u=this._index.filenames,c=this._index.titles,h={},l={},d=[];for(a=0;a<e.length;a++){var f=e[a],p=[],m=[{files:r[f],score:Scorer.term},{files:n[f],score:Scorer.title}];if(f.length>2){for(var S in r)S.match(f)&&!r[f]&&m.push({files:r[S],score:Scorer.partialTerm});for(var S in n)S.match(f)&&!n[f]&&m.push({files:n[S],score:Scorer.partialTitle})}if($u.every(m,function(e){return e.files===undefined}))break;for($u.each(m,function(e){var t=e.files;if(t!==undefined)for(t.length===undefined&&(t=[t]),p=p.concat(t),i=0;i<t.length;i++)(s=t[i])in l||(l[s]={}),l[s][f]=e.score}),i=0;i<p.length;i++)(s=p[i])in h&&-1===h[s].indexOf(f)?h[s].push(f):h[s]=[f]}for(s in h){var _=!0,x=e.filter(function(e){return e.length>2}).length;if(h[s].length==e.length||h[s].length==x){for(a=0;a<t.length;a++)if(r[t[a]]==s||n[t[a]]==s||$u.contains(r[t[a]]||[],s)||$u.contains(n[t[a]]||[],s)){_=!1;break}if(_){var g=$u.max($u.map(h[s],function(e){return l[s][e]}));d.push([o[s],c[s],"",null,g,u[s]])}}}return d},makeSearchSummary:function(e,t,r){var n=Search.htmlToText(e),a=n.toLowerCase(),i=0;$.each(t,function(){var e=a.indexOf(this.toLowerCase());e>-1&&(i=e)});var s=((i=Math.max(i-120,0))>0?"...":"")+$.trim(n.substr(i,240))+(i+240-n.length?"...":""),o=$('<div class="context"></div>').text(s);return $.each(r,function(){o=o.highlightText(this,"highlighted")}),o}};$(document).ready(function(){Search.init()});